angular.module("ui.sortable",[]).value("uiSortableConfig",{}).directive("uiSortable",["uiSortableConfig","$timeout","$log",function(e,t,n){return{require:"?ngModel",link:function(r,i,s,o){function a(e,t){return t&&typeof t=="function"?function(n,r){e(n,r),t(n,r)}:e}var u,f={},l={receive:null,remove:null,start:null,stop:null,update:null};angular.extend(f,e),o?(r.$watch(s.ngModel+".length",function(){t(function(){!i.data("ui-sortable")||i.sortable("refresh")})}),l.start=function(e,t){t.item.sortable={index:t.item.index(),cancel:function(){t.item.sortable._isCanceled=!0},isCanceled:function(){return t.item.sortable._isCanceled},_isCanceled:!1}},l.activate=function(){u=i.contents();var e=i.sortable("option","placeholder");if(e&&e.element&&typeof e.element=="function"){var t=e.element();t.jquery||(t=angular.element(t));var n=i.find('[class="'+t.attr("class")+'"]');u=u.not(n)}},l.update=function(e,t){t.item.sortable.received||(t.item.sortable.dropindex=t.item.index(),t.item.sortable.droptarget=t.item.parent(),i.sortable("cancel")),i.sortable("option","helper")==="clone"&&(u=u.not(u.last())),u.appendTo(i),t.item.sortable.received&&!t.item.sortable.isCanceled()&&r.$apply(function(){o.$modelValue.splice(t.item.sortable.dropindex,0,t.item.sortable.moved)})},l.stop=function(e,t){!t.item.sortable.received&&"dropindex"in t.item.sortable&&!t.item.sortable.isCanceled()?r.$apply(function(){o.$modelValue.splice(t.item.sortable.dropindex,0,o.$modelValue.splice(t.item.sortable.index,1)[0])}):(!("dropindex"in t.item.sortable)||t.item.sortable.isCanceled())&&i.sortable("option","helper")!=="clone"&&u.appendTo(i)},l.receive=function(e,t){t.item.sortable.received=!0},l.remove=function(e,t){t.item.sortable.isCanceled()||r.$apply(function(){t.item.sortable.moved=o.$modelValue.splice(t.item.sortable.index,1)[0]})},r.$watch(s.uiSortable,function(e){!i.data("ui-sortable")||angular.forEach(e,function(e,t){l[t]&&(t==="stop"&&(e=a(e,function(){r.$apply()})),e=a(l[t],e)),i.sortable("option",t,e)})},!0),angular.forEach(l,function(e,t){f[t]=a(e,f[t])})):n.info("ui.sortable: ngModel not provided!",i),i.sortable(f)}}}]);